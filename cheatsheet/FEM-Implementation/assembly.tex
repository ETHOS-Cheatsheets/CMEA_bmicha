%!Tex root=ZF_bmicha_CMEA.tex
\subsection{Assembly}
    \makeatletter \@totalleftmargin=-1.1cm \makeatother
    \begin{verbatim}
        A = zeros(N,N); F = zeros(N);
        for m = 1 : M,
          Approximate A^Km , F^Km as above
          for alpha = 1 : 3,
            F(T(alpha,m)) += F_alpha^Km
            for beta = 1:3,
             A(T(alpha,m),T(beta,m)) += A_alpha,beta^Km
            end
          end
        end
    \end{verbatim}\vspace{-1.5em}
    \subsubsection{Homogeneous BC}
        In case of homogeneous boundary conditions, all contributions from \textit{boundary nodes} should be \textit{skipped}.
        \makeatletter \@totalleftmargin=-1.7cm \makeatother
        \begin{verbatim}
            compute A and F from above
            compute InteriorNodes
            A = A(InteriorNodes,InteriorNodes)
            F = F(InteriorNodes)
        \end{verbatim}
        \vspace{-1.25em}